import{_ as A,r as m,c as w,a as e,w as t,b as n,d as R,p as D,e as F,o as y,f as u,t as C,F as G,h as M,i as P,E as v}from"./index-CXbMACjM.js";const j=d=>(D("data-v-795d5f30"),d=d(),F(),d),H={class:"page-container"},J=j(()=>R("div",{class:"page-title"},"自动运维",-1)),K={class:"mb-2 flex-row"},O={__name:"Automation",setup(d){const f=m([{name:"每日备份",type:"计划任务",status:"已完成",lastRun:"2024-05-10 02:00",log:[{time:"2024-05-10 02:00",type:"success",content:"任务执行成功"},{time:"2024-05-09 02:00",type:"success",content:"任务执行成功"}]},{name:"主机健康检查",type:"脚本",status:"待执行",lastRun:"",log:[]},{name:"存储空间清理",type:"脚本",status:"已完成",lastRun:"2024-05-09 03:00",log:[{time:"2024-05-09 03:00",type:"success",content:"释放空间 2.3GB"},{time:"2024-05-08 03:00",type:"success",content:"释放空间 1.8GB"}]},{name:"系统安全扫描",type:"计划任务",status:"执行中",lastRun:"2024-05-10 01:00",log:[{time:"2024-05-10 01:00",type:"info",content:"扫描中..."},{time:"2024-05-09 01:00",type:"success",content:"未发现高危漏洞"}]},{name:"资源用量统计",type:"计划任务",status:"已完成",lastRun:"2024-05-10 00:30",log:[{time:"2024-05-10 00:30",type:"success",content:"统计完成，CPU平均利用率 35%"}]},{name:"业务服务重启",type:"脚本",status:"待执行",lastRun:"",log:[]},{name:"日志归档",type:"计划任务",status:"已完成",lastRun:"2024-05-09 23:00",log:[{time:"2024-05-09 23:00",type:"success",content:"归档日志 120MB"}]},{name:"网络连通性检测",type:"脚本",status:"已完成",lastRun:"2024-05-10 04:00",log:[{time:"2024-05-10 04:00",type:"success",content:"所有节点网络正常"},{time:"2024-05-09 04:00",type:"error",content:"节点 192.168.1.10 丢包率高"}]}]),i=m(!1),_=m(!1),o=m({name:"",type:""}),g=m([]);function x(){!o.value.name||!o.value.type||(f.value.push({name:o.value.name,type:o.value.type,status:"待执行",lastRun:"",log:[]}),i.value=!1,o.value={name:"",type:""},v.success("新建任务成功"))}function B(s){f.value.splice(s,1),v.success("删除任务成功")}function $(s){s.status="执行中",setTimeout(()=>{s.status="已完成";const a=new Date().toLocaleString();s.lastRun=a,s.log.unshift({time:a,type:"success",content:"任务执行成功"}),v.success("任务执行完成")},1e3)}function L(s){g.value=s.log,_.value=!0}return(s,a)=>{const c=n("el-button"),p=n("el-table-column"),S=n("el-tag"),T=n("el-space"),U=n("el-table"),I=n("el-card"),z=n("el-input"),b=n("el-form-item"),k=n("el-option"),E=n("el-select"),N=n("el-form"),V=n("el-dialog"),h=n("el-timeline-item"),q=n("el-timeline");return y(),w("div",H,[J,e(I,null,{default:t(()=>[R("div",K,[e(c,{type:"primary",onClick:a[0]||(a[0]=l=>i.value=!0)},{default:t(()=>[u("新建任务")]),_:1})]),e(U,{data:f.value,style:{width:"100%"}},{default:t(()=>[e(p,{prop:"name",label:"任务名称"}),e(p,{prop:"type",label:"类型"}),e(p,{prop:"status",label:"状态"},{default:t(l=>[e(S,{type:l.row.status==="已完成"?"success":l.row.status==="执行中"?"warning":"info"},{default:t(()=>[u(C(l.row.status),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"lastRun",label:"上次执行时间"}),e(p,{label:"操作",width:"220"},{default:t(l=>[e(T,null,{default:t(()=>[e(c,{size:"small",onClick:r=>$(l.row)},{default:t(()=>[u("执行")]),_:2},1032,["onClick"]),e(c,{size:"small",onClick:r=>L(l.row)},{default:t(()=>[u("日志")]),_:2},1032,["onClick"]),e(c,{size:"small",type:"danger",onClick:r=>B(l.$index)},{default:t(()=>[u("删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1}),e(V,{modelValue:i.value,"onUpdate:modelValue":a[4]||(a[4]=l=>i.value=l),title:"新建自动化任务",width:"400px"},{footer:t(()=>[e(c,{onClick:a[3]||(a[3]=l=>i.value=!1)},{default:t(()=>[u("取消")]),_:1}),e(c,{type:"primary",onClick:x},{default:t(()=>[u("确定")]),_:1})]),default:t(()=>[e(N,{model:o.value,"label-width":"80px"},{default:t(()=>[e(b,{label:"任务名称",required:""},{default:t(()=>[e(z,{modelValue:o.value.name,"onUpdate:modelValue":a[1]||(a[1]=l=>o.value.name=l)},null,8,["modelValue"])]),_:1}),e(b,{label:"类型",required:""},{default:t(()=>[e(E,{modelValue:o.value.type,"onUpdate:modelValue":a[2]||(a[2]=l=>o.value.type=l)},{default:t(()=>[e(k,{label:"脚本",value:"脚本"}),e(k,{label:"计划任务",value:"计划任务"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(V,{modelValue:_.value,"onUpdate:modelValue":a[6]||(a[6]=l=>_.value=l),title:"任务日志",width:"500px"},{footer:t(()=>[e(c,{onClick:a[5]||(a[5]=l=>_.value=!1)},{default:t(()=>[u("关闭")]),_:1})]),default:t(()=>[e(q,null,{default:t(()=>[(y(!0),w(G,null,M(g.value,(l,r)=>(y(),P(h,{key:r,timestamp:l.time,type:l.type},{default:t(()=>[u(C(l.content),1)]),_:2},1032,["timestamp","type"]))),128))]),_:1})]),_:1},8,["modelValue"])])}}},W=A(O,[["__scopeId","data-v-795d5f30"]]);export{W as default};
